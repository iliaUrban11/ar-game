<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <title>Грандаксин против</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
  <script src="https://raw.githack.com/AR-js-org/AR.js/3.4.7/aframe/build/aframe-ar-nft.js"></script>
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:-apple-system,system-ui,sans-serif;background:linear-gradient(135deg,#027ACA,#00b894);overflow:hidden;height:100vh;color:#fff}
    #startPage{position:fixed;inset:0;z-index:9999;display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;padding:30px;background:rgba(255,255,255,.95);color:#027ACA}
    #logo{font-size:3.2em;font-weight:900;margin-bottom:20px}
    #rules{font-size:1.35em;line-height:1.7;margin-bottom:50px}
    #startGameBtn{padding:18px 60px;background:#027ACA;color:#fff;font-size:1.6em;font-weight:700;border:none;border-radius:50px;cursor:pointer}
    #gameUI{position:fixed;z-index:1000;display:none;width:100%;pointer-events:none}
    #timer{position:fixed;top:20px;left:50%;transform:translateX(-50%);background:rgba(255,255,255,.95);color:#027ACA;padding:12px 28px;border-radius:30px;font-size:2.2em;font-weight:900}
    #progress{position:fixed;top:90px;left:20px;right:20px;display:flex;gap:12px}
    .bar{flex:1;height:40px;background:rgba(255,255,255,.15);border-radius:20px;overflow:hidden;position:relative}
    .fill{height:100%;width:0%;transition:width .7s ease;border-radius:20px}
    .label{position:absolute;top:50%;left:18px;transform:translateY(-50%);font-size:15px;font-weight:700;color:#fff;text-shadow:1px 1px 3px #000}
    #nerv-fill{background:#00859D}#anx-fill{background:#411D6B}#stress-fill{background:#EB4C24}
    #uiText{position:fixed;bottom:20px;left:0;right:0;background:rgba(255,255,255,.9);color:#027ACA;padding:14px 20px;font-size:1.15em;text-align:center;line-height:1.5}
    #endScreen{position:fixed;inset:0;z-index:9999;display:none;flex-direction:column;justify-content:center;align-items:center;background:rgba(2,122,202,.98);padding:40px;text-align:center}
    #endTitle{font-size:3em;font-weight:900;margin-bottom:30px}
    #endProgress{width:85%;max-width:500px;display:flex;flex-direction:column;gap:18px;margin:30px 0}
    #endResults{font-size:1.7em;line-height:2;margin:20px 0}
    #playAgainBtn{padding:18px 55px;background:#fff;color:#027ACA;font-size:1.5em;font-weight:800;border:none;border-radius:50px;cursor:pointer}
  </style>
</head>
<body>

  <div id="startPage">
    <div id="logo">ГРАНДАКСИН ПРОТИВ1</div>
    <div id="rules">
      Совместите цель с летающим симптомом<br>и нажмите на экран.<br><br>
      Сбейте как можно больше за 30 секунд!
    </div>
    <button id="startGameBtn">НАЧАТЬ</button>
  </div>

  <div id="gameUI">
    <div id="timer">30</div>
    <div id="progress">
      <div class="bar"><div class="label">Нервозность</div><div id="nerv-fill" class="fill"></div></div>
      <div class="bar"><div class="label">Тревога</div><div id="anx-fill" class="fill"></div></div>
      <div class="bar"><div class="label">Стресс</div><div id="stress-fill" class="fill"></div></div>
    </div>
    <div id="uiText">Совместите цель с летающим симптомом<br>и нажмите на экран</div>
  </div>

  <div id="endScreen">
    <div id="endTitle">Спасибо за игру!</div>
    <div id="endProgress">
      <div class="bar"><div class="label">Нервозность</div><div id="end-nerv-fill" class="fill"></div></div>
      <div class="bar"><div class="label">Тревога</div><div id="end-anx-fill" class="fill"></div></div>
      <div class="bar"><div class="label">Стресс</div><div id="end-stress-fill" class="fill"></div></div>
    </div>
    <div id="endResults">
      Вы уничтожили:<br>
      <span id="nerv-result"></span><br>
      <span id="anx-result"></span><br>
      <span id="stress-result"></span>
    </div>
    <button id="playAgainBtn">ИГРАТЬ ЕЩЁ РАЗ</button>
  </div>

  <audio id="hitSound" src="hit.mp3" preload="auto"></audio>

  <a-scene embedded
    arjs="sourceType: webcam;
          detectionMode: mono;
          trackingMethod: best;
          debugUIEnabled: false;
          maxDetectionRate: 30;
          canvasWidth: 640;
          canvasHeight: 480;
          smoothingFactor: 0.95;"
    renderer="antialias: true"
    vr-mode-ui="enabled: false"
    device-orientation-permission-ui="enabled: false"
    style="display:none"
    cursor="rayOrigin: mouse"
    raycaster="objects: .clickable">

    <a-assets timeout="60000">
      <a-asset-item id="nerv"   src="red.glb"></a-asset-item>
      <a-asset-item id="anx"    src="green.glb"></a-asset-item>
      <a-asset-item id="stress" src="blue.glb"></a-asset-item>
    </a-assets>

    <a-camera look-controls="enabled: true">
      <a-cursor position="0 0 -1" geometry="primitive: ring; radiusInner: 0.02; radiusOuter: 0.03"
                material="color: white; shader: flat; opacity: 0.6"></a-cursor>
    </a-camera>

    <a-entity id="models"></a-entity>
  </a-scene>

  <script src="game.js"></script>
</body>
</html>
